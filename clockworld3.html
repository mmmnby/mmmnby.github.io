
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Responsive 24-Hour World Timer</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: linear-gradient(to bottom, #e0f0ff, #a0d0ff);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: system-ui, sans-serif;
      touch-action: manipulation;
      color: #222;
    }

    canvas { display: block; touch-action: none; }
    
    #info {
      margin: 0.6em 0;
      font-size: 1.15rem;
      font-weight: 500;
      text-align: center;
    }

    #controls {
      display: flex;
      gap: 1rem;
      margin: 0.8em 0;
    }

    button {
      font-size: 1.3rem;
      padding: 0.4em 1em;
      min-width: 3.5em;
      cursor: pointer;
      border: 1px solid #888;
      background: white;
      border-radius: 6px;
      touch-action: manipulation;
    }

    #timeZoneSlider {
      width: 90vw;
      max-width: 520px;
      height: 2.4em;
      margin: 1em auto;
      background: #e0e0e0;
      border-radius: 8px;
      position: relative;
      touch-action: pan-y;
      user-select: none;
    }

    #timeZoneSlider::after {
      content: "Swipe left/right to change zone";
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #555;
      font-size: 0.9rem;
      pointer-events: none;
    }
  </style>
</head>
<body>

  <canvas id="clock"></canvas>

  <div id="info">
    <div id="utcTime"></div>
    <div id="localTime"></div>
  </div>

  <div id="controls">
    <button id="prev">←</button>
    <button id="next">→</button>
  </div>

  <div id="timeZoneSlider"></div>

  <script>
    // ────────────────────────────────────────────────
    //  Constants & Data
    // ────────────────────────────────────────────────
    const TIME_ZONES = [
      { city: 'Pago Pago',   offset: -11 },
      { city: 'Honolulu',    offset: -10 },
      { city: 'Anchorage',   offset:  -9 },
      { city: 'Los Angeles', offset:  -8 },
      { city: 'Denver',      offset:  -7 },
      { city: 'Mexico City', offset:  -6 },
      { city: 'New York',    offset:  -5 },
      { city: 'Santiago',    offset:  -4 },
      { city: 'Buenos Aires',offset:  -3 },
      { city: 'Ponta Delgada',offset: -2 },
      { city: 'Azores',      offset:  -1 },
      { city: 'London',      offset:   0 },
      { city: 'Berlin',      offset:  +1 },
      { city: 'Cairo',       offset:  +2 },
      { city: 'Moscow',      offset:  +3 },
      { city: 'Dubai',       offset:  +4 },
      { city: 'Karachi',     offset:  +5 },
      { city: 'Dhaka',       offset:  +6 },
      { city: 'Bangkok',     offset:  +7 },
      { city: 'Beijing',     offset:  +8 },
      { city: 'Tokyo',       offset:  +9 },
      { city: 'Sydney',      offset: +10 },
      { city: 'Noumea',      offset: +11 },
      { city: 'Auckland',    offset: +12 },
    ];

    const MAP_IMAGE_SRC = 'worldmap.jpg'; // ← make sure this file is available

    // ────────────────────────────────────────────────
    //  State
    // ────────────────────────────────────────────────
    const state = {
      canvas: document.getElementById('clock'),
      ctx: null,
      mapImage: new Image(),
      currentZoneIndex: TIME_ZONES.findIndex(z => z.offset === -new Date().getTimezoneOffset() / 60) || 11,
      dpr: window.devicePixelRatio || 1,
    };

    state.ctx = state.canvas.getContext('2d');

    // ────────────────────────────────────────────────
    //  DOM Elements
    // ────────────────────────────────────────────────
    const utcEl     = document.getElementById('utcTime');
    const localEl   = document.getElementById('localTime');
    const prevBtn   = document.getElementById('prev');
    const nextBtn   = document.getElementById('next');
    const slider    = document.getElementById('timeZoneSlider');

    // ────────────────────────────────────────────────
    //  Core Drawing Functions
    // ────────────────────────────────────────────────
    function resizeCanvas() {
      const size = Math.min(window.innerWidth, window.innerHeight) * 0.86;
      state.canvas.style.width  = `${size}px`;
      state.canvas.style.height = `${size}px`;
      state.canvas.width  = size * state.dpr;
      state.canvas.height = size * state.dpr;
      state.ctx.scale(state.dpr, state.dpr);
      draw();
    }

    function getTimeInfo() {
      const now = new Date();
      return {
        utcHours:   now.getUTCHours()   + now.getUTCMinutes()/60 + now.getUTCSeconds()/3600,
        utcH:       now.getUTCHours(),
        utcM:       now.getUTCMinutes(),
        utcS:       now.getUTCSeconds(),
      };
    }

    function draw() {
      const { canvas, ctx, mapImage, currentZoneIndex } = state;
      const size   = canvas.offsetWidth;
      const cx     = size / 2;
      const cy     = size / 2;
      const radius = size / 2 * 0.95;

      ctx.clearRect(0, 0, size, size);
      ctx.save();
      ctx.translate(cx, cy);

      const { utcHours } = getTimeInfo();
      const rotation = -(utcHours % 24 - 12) * (Math.PI / 12);

      // ── Rotating layer (numbers + cities + map rotation reference) ──
      ctx.save();
      ctx.rotate(rotation);

      // Map (clipped)
      const mapR = radius * 0.56;
      ctx.save();
      ctx.beginPath();
      ctx.arc(0, 0, mapR, 0, Math.PI * 2);
      ctx.clip();

      if (mapImage.complete && mapImage.naturalWidth > 0) {
        ctx.drawImage(mapImage, -mapR, -mapR, mapR*2, mapR*2);
      } else {
        ctx.fillStyle = '#c0e0ff';
        ctx.fillRect(-mapR, -mapR, mapR*2, mapR*2);
        ctx.fillStyle = '#333';
        ctx.font = 'bold 48px sans-serif';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText("World Map", 0, 0);
      }
      ctx.restore();

      drawDayNight(mapR);
      drawNumbersAndCities(radius, mapR);

      ctx.restore(); // end rotating layer

      // Fixed elements
      drawBorder(mapR);
      drawFixedPointer(mapR);

      ctx.restore();
    }

    function drawBorder(r) {
      state.ctx.beginPath();
      state.ctx.arc(0, 0, r, 0, Math.PI * 2);
      state.ctx.lineWidth = 2.5;
      state.ctx.strokeStyle = '#334';
      state.ctx.stroke();
    }

    function drawFixedPointer(mapR) {
      const len = mapR * 0.16;
      state.ctx.save();
      state.ctx.rotate(-Math.PI / 2);
      state.ctx.translate(mapR * 1.04, 0);

      state.ctx.beginPath();
      state.ctx.moveTo(0, 0);
      state.ctx.lineTo(-len, -len/2.2);
      state.ctx.lineTo(-len,  len/2.2);
      state.ctx.closePath();
      state.ctx.fillStyle = '#c00';
      state.ctx.fill();

      state.ctx.restore();
    }

    function drawDayNight(r) {
      const h = getTimeInfo().utcHours;
      const angle = (h / 24) * Math.PI * 2;

      state.ctx.save();
      state.ctx.rotate(angle);

      state.ctx.beginPath();
      state.ctx.arc(0, 0, r, Math.PI / 2, Math.PI * 1.5); // night side
      state.ctx.fillStyle = 'rgba(20, 30, 80, 0.28)';
      state.ctx.fill();

      state.ctx.restore();
    }

    function drawNumbersAndCities(outerR, mapR) {
      const numR   = mapR + (outerR - mapR) * 0.18;
      const cityR  = mapR + (outerR - mapR) * 0.57;
      const numSize  = outerR * 0.052;
      const citySize = outerR * 0.058;

      // Number ring background segments
      state.ctx.lineWidth = numSize * 2.4;
      for (let h = 0; h < 24; h++) {
        const a = (h - 12) * Math.PI / 12 - Math.PI / 2;
        state.ctx.beginPath();
        state.ctx.arc(0, 0, numR, a - Math.PI/48, a + Math.PI/48);
        state.ctx.strokeStyle = (h >= 19 || h <= 5) ? '#222' : '#f8f8f8';
        state.ctx.stroke();
      }

      // Hour numbers
      state.ctx.font = `bold ${numSize}px sans-serif`;
      state.ctx.textAlign = 'center';
      state.ctx.textBaseline = 'middle';

      for (let h = 0; h < 24; h++) {
        const num = h === 0 ? 24 : h;
        const a = (h - 12) * Math.PI / 12 - Math.PI / 2;
        const x = numR * Math.cos(a);
        const y = numR * Math.sin(a);

        state.ctx.save();
        state.ctx.translate(x, y);
        state.ctx.rotate(a + Math.PI / 2);
        state.ctx.fillStyle = (h >= 19 || h <= 5) ? '#fff' : '#222';
        state.ctx.fillText(num, 0, 0);
        state.ctx.restore();
      }

      // City names (static – no rotation applied here)
      state.ctx.font = `600 ${citySize}px sans-serif`;
      const startAngle = Math.PI / 2 - Math.PI / 12;

      TIME_ZONES.forEach((zone, i) => {
        const a = startAngle - i * (Math.PI / 12);
        const stagger = (i % 2 === 0) ? 0 : outerR * 0.085;
        const r = cityR + stagger;

        const x = r * Math.cos(a);
        const y = r * Math.sin(a);

        state.ctx.save();
        state.ctx.translate(x, y);
        state.ctx.rotate(y < 0 ? a + Math.PI / 2 : a - Math.PI / 2);
        state.ctx.fillStyle = '#111';
        state.ctx.fillText(zone.city, 0, 0);
        state.ctx.restore();
      });
    }

    // ────────────────────────────────────────────────
    //  UI Updates
    // ────────────────────────────────────────────────
    function updateTimeDisplays() {
      const { utcH, utcM, utcS } = getTimeInfo();
      const zone = TIME_ZONES[state.currentZoneIndex];
      const localH = (utcH + zone.offset + 24) % 24;

      utcEl.textContent   = `UTC  ${utcH.toString().padStart(2,'0')}:${utcM.toString().padStart(2,'0')}:${utcS.toString().padStart(2,'0')}`;
      localEl.textContent = `${localH.toString().padStart(2,'0')}:${utcM.toString().padStart(2,'0')}:${utcS.toString().padStart(2,'0')}  —  ${zone.city}  (UTC${zone.offset >= 0 ? '+' : ''}${zone.offset})`;
    }

    function changeZone(delta) {
      state.currentZoneIndex = (state.currentZoneIndex + delta + TIME_ZONES.length) % TIME_ZONES.length;
      updateTimeDisplays();
    }

    // ────────────────────────────────────────────────
    //  Event Listeners
    // ────────────────────────────────────────────────
    window.addEventListener('resize', resizeCanvas);
    prevBtn.addEventListener('click', () => changeZone(-1));
    nextBtn.addEventListener('click', () => changeZone(+1));

    // Touch swipe
    let touchStartX = 0;
    slider.addEventListener('touchstart', e => {
      touchStartX = e.touches[0].clientX;
    }, { passive: false });

    slider.addEventListener('touchend', e => {
      const dx = e.changedTouches[0].clientX - touchStartX;
      if (Math.abs(dx) > 60) {
        changeZone(dx > 0 ? -1 : +1);
      }
    }, { passive: false });

    // ────────────────────────────────────────────────
    //  Initialization
    // ────────────────────────────────────────────────
    state.mapImage.src = MAP_IMAGE_SRC;
    state.mapImage.crossOrigin = 'anonymous'; // in case you host it elsewhere later
    state.mapImage.onload = resizeCanvas;

    // Start animation loop
    setInterval(() => {
      draw();
      updateTimeDisplays();
    }, 1000);

    // First draw & update (in case image is cached)
    resizeCanvas();
    updateTimeDisplays();
  </script>
</body>
</html>

