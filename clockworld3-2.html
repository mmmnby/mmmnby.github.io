<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Responsive 24-Hour World Timer</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: linear-gradient(to bottom, #e0f0ff, #a0d0ff);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      touch-action: manipulation;
    }
    #clockCanvas { display: block; }
    
    #clockDataContainer {
      margin-top: 15px;
      text-align: center;
      background: rgba(255, 255, 255, 0.7);
      padding: 10px 25px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      min-width: 280px;
    }

    #digitalClock {
      font-size: 1.2em;
      font-weight: 700;
      color: #555;
      margin-bottom: 4px;
    }

    #localTimeContainer {
      font-size: 1.1em;
      font-weight: 500;
      color: #000;
    }
    
    #citySelectors {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      background: rgba(255, 255, 255, 0.5);
      padding: 15px 25px;
      border-radius: 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    .select-group {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 280px;
      font-weight: bold;
    }

    .select-group select {
      padding: 6px;
      border-radius: 6px;
      border: 1px solid #bbb;
      width: 150px;
      background: white;
      cursor: pointer;
    }

    .color-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
    }
  </style>
</head>
<body>

  <canvas id="clockCanvas"></canvas>

  <div id="clockDataContainer">
    <div id="digitalClock">UTC: 00:00:00</div>
    <div id="localTimeContainer">
      <span id="localTimeDisplay">00:00:00 — Loading...</span>
    </div>
  </div>

  <div id="citySelectors">
    <div class="select-group">
      <span><span class="color-indicator" style="background:#00FF00;"></span>Origin:</span>
      <select id="originSelect"></select>
    </div>
    <div class="select-group">
      <span><span class="color-indicator" style="background:#333;"></span>Time Zone:</span>
      <select id="tzSelect"></select>
    </div>
    <div class="select-group">
      <span><span class="color-indicator" style="background:#FF0000;"></span>Destination:</span>
      <select id="destSelect"></select>
    </div>
  </div>

  <script>
    const globalCities = [
      { name: 'London', lat: 51.5074, lng: -0.1278, offset: 0 },
      { name: 'New York', lat: 40.7128, lng: -74.0060, offset: -5 },
      { name: 'Paris', lat: 48.8566, lng: 2.3522, offset: 1 },
      { name: 'Beijing', lat: 39.9042, lng: 116.4074, offset: 8 },
      { name: 'Tokyo', lat: 35.6762, lng: 139.6503, offset: 9 },
      { name: 'Los Angeles', lat: 34.0522, lng: -118.2437, offset: -8 },
      { name: 'Dubai', lat: 25.2048, lng: 55.2708, offset: 4 },
      { name: 'Singapore', lat: 1.3521, lng: 103.8198, offset: 8 },
      { name: 'Hong Kong', lat: 22.3193, lng: 114.1694, offset: 8 },
      { name: 'Sydney', lat: -33.8688, lng: 151.2093, offset: 10 },
      { name: 'São Paulo', lat: -23.5505, lng: -46.6333, offset: -3 },
      { name: 'Mumbai', lat: 19.0760, lng: 72.8777, offset: 5.5 },
      { name: 'Moscow', lat: 55.7558, lng: 37.6173, offset: 3 },
      { name: 'Seoul', lat: 37.5665, lng: 126.9780, offset: 9 },
      { name: 'Toronto', lat: 43.6510, lng: -79.3470, offset: -5 },
      { name: 'Berlin', lat: 52.5200, lng: 13.4050, offset: 1 },
      { name: 'Madrid', lat: 40.4168, lng: -3.7038, offset: 1 },
      { name: 'Rome', lat: 41.9028, lng: 12.4964, offset: 1 },
      { name: 'Buenos Aires', lat: -34.6037, lng: -58.3816, offset: -3 },
      { name: 'Mexico City', lat: 19.4326, lng: -99.1332, offset: -6 },
      { name: 'Cairo', lat: 30.0444, lng: 31.2357, offset: 2 },
      { name: 'Istanbul', lat: 41.0082, lng: 28.9784, offset: 3 },
      { name: 'Bangkok', lat: 13.7563, lng: 100.5018, offset: 7 },
      { name: 'Chicago', lat: 41.8781, lng: -87.6298, offset: -6 },
      { name: 'Jakarta', lat: -6.2088, lng: 106.8456, offset: 7 }
    ];

    // Static mapping for the ring labels (24 hour zones)
    const ringLabels = [
      { city: 'Pago Pago',  offset: -11 }, { city: 'Honolulu',   offset: -10 },
      { city: 'Anchorage',  offset:  -9 }, { city: 'Los Angls',  offset:  -8 },
      { city: 'Denver',     offset:  -7 }, { city: 'MexicoCit',  offset:  -6 },
      { city: 'New York',   offset:  -5 }, { city: 'Santiago',   offset:  -4 },
      { city: 'BuenosAir',  offset:  -3 }, { city: 'Ponta Del',  offset:  -2 },
      { city: 'Azores',     offset:  -1 }, { city: 'London',     offset:   0 },
      { city: 'Berlin',     offset:  +1 }, { city: 'Cairo',      offset:  +2 },
      { city: 'Moscow',     offset:  +3 }, { city: 'Dubai',      offset:  +4 },
      { city: 'Karachi',    offset:  +5 }, { city: 'Dhaka',      offset:  +6 },
      { city: 'Bangkok',    offset:  +7 }, { city: 'Beijing',    offset:  +8 },
      { city: 'Tokyo',      offset:  +9 }, { city: 'Sydney',     offset: +10 },
      { city: 'Noumea',     offset: +11 }, { city: 'Auckland',   offset: +12 }
    ];

    const originSelect = document.getElementById('originSelect');
    const tzSelect = document.getElementById('tzSelect');
    const destSelect = document.getElementById('destSelect');

    globalCities.forEach((city, index) => {
      originSelect.add(new Option(city.name, index));
      tzSelect.add(new Option(city.name, index));
      destSelect.add(new Option(city.name, index));
    });

    originSelect.selectedIndex = 0; 
    tzSelect.selectedIndex = 4;     
    destSelect.selectedIndex = 1;   

    const RADIUS_COEFFICIENTS = {
      outerTickRing: 0.97,
      staticNumbers: 0.86,
      redArrowOrbit: 0.82,
      magentaArrowOrbit: 0.925,
      worldMap: 0.495,
      hourNumberRing: 0.55575,
      cityLabelRing: 0.668,
      cityLabelStagger: 0.072
    };

    const POINTER_CONFIG = {
      hourHand: { length: 32, baseWidth: 12, tipWidth: 6, color1: '#ff4d4d', color2: '#991900' },
      minuteHand: { length: 49, baseWidth: 12, tipWidth: 4, color1: '#FF00FF', color2: '#D100D1' }
    };

    const worldMapImage = new Image();
    worldMapImage.src = 'worldmap.jpg'; 
    worldMapImage.onload = onWindowResize;

    const clockCanvasElement = document.getElementById('clockCanvas');
    const canvasContext = clockCanvasElement.getContext('2d');
    const digitalClockElement = document.getElementById('digitalClock');
    const localTimeDisplayElement = document.getElementById('localTimeDisplay');

    function onWindowResize() {
      const canvasSize = Math.min(window.innerWidth, window.innerHeight * 0.6);
      const devicePixelRatio = window.devicePixelRatio || 1;
      clockCanvasElement.style.width = canvasSize + "px";
      clockCanvasElement.style.height = canvasSize + "px";
      clockCanvasElement.width = canvasSize * devicePixelRatio;
      clockCanvasElement.height = canvasSize * devicePixelRatio;
      canvasContext.scale(devicePixelRatio, devicePixelRatio);
      drawClockFace();
    }

    window.addEventListener('resize', onWindowResize);
    [originSelect, tzSelect, destSelect].forEach(el => el.addEventListener('change', drawClockFace));

    function drawClockFace() {
      const canvasWidth = parseFloat(clockCanvasElement.style.width);
      const universalRadius = canvasWidth / 2;
      canvasContext.clearRect(0, 0, canvasWidth, canvasWidth);
      canvasContext.save();
      canvasContext.translate(universalRadius, universalRadius);

      const mapRadius = universalRadius * RADIUS_COEFFICIENTS.worldMap;
      canvasContext.save();
      canvasContext.beginPath();
      canvasContext.arc(0, 0, mapRadius, 0, Math.PI * 2);
      canvasContext.clip();

      if (worldMapImage.complete && worldMapImage.naturalWidth > 0) {
        canvasContext.drawImage(worldMapImage, -mapRadius, -mapRadius, mapRadius * 2, mapRadius * 2);
      } else {
        canvasContext.fillStyle = '#a0d0ff';
        canvasContext.fill();
      }

      drawCityDot(globalCities[originSelect.value], mapRadius, '#00FF00');
      drawCityDot(globalCities[destSelect.value], mapRadius, '#FF0000');
      canvasContext.restore();

      drawClockBorder(mapRadius);
      drawOuterTickRing(universalRadius * RADIUS_COEFFICIENTS.outerTickRing);
      drawOuterStaticNumberRing(universalRadius * RADIUS_COEFFICIENTS.staticNumbers);
      drawHourNumbersAndCities(universalRadius);
      
      drawTrapezoidPointer(RADIUS_COEFFICIENTS.magentaArrowOrbit * universalRadius, calculateMinuteAngle(), POINTER_CONFIG.minuteHand, 4);
      drawTrapezoidPointer(RADIUS_COEFFICIENTS.redArrowOrbit * universalRadius, calculateHourAngle(), POINTER_CONFIG.hourHand, 6);
      
      canvasContext.restore();
    }

    function drawCityDot(city, mapRadius, color) {
      const angle = -city.lng * (Math.PI / 180) - (Math.PI / 2);
      const normalizedRadius = (90 - city.lat) / 180;
      const r = mapRadius * normalizedRadius;
      const x = r * Math.cos(angle);
      const y = r * Math.sin(angle);
      
      canvasContext.beginPath();
      canvasContext.arc(x, y, mapRadius * 0.04, 0, Math.PI * 2); 
      canvasContext.fillStyle = color;
      canvasContext.fill();
      canvasContext.strokeStyle = '#FFFFFF';
      canvasContext.lineWidth = 1.5;
      canvasContext.stroke();
    }

    function calculateHourAngle() {
      const offset = globalCities[tzSelect.value].offset;
      const now = new Date();
      const utcFloat = now.getUTCHours() + (now.getUTCMinutes() / 60) + (now.getUTCSeconds() / 3600);
      let localFloat = (utcFloat + offset) % 24;
      if (localFloat < 0) localFloat += 24;
      return ((localFloat - 12) * Math.PI / 12) - Math.PI / 2;
    }

    function calculateMinuteAngle() {
      const offset = globalCities[tzSelect.value].offset;
      const now = new Date();
      const fractionalHours = offset % 1;
      let minutesFloat = now.getUTCMinutes() + (now.getUTCSeconds() / 60) + (fractionalHours * 60);
      minutesFloat = (minutesFloat % 60 + 60) % 60; 
      return (minutesFloat * Math.PI / 30) - Math.PI / 2;
    }

    function drawTrapezoidPointer(orbitRadius, angle, config, shadow) {
      canvasContext.save();
      canvasContext.rotate(angle);
      canvasContext.translate(orbitRadius, 0); 
      const gradient = canvasContext.createLinearGradient(0, 0, -config.length, 0);
      gradient.addColorStop(0, config.color1); 
      gradient.addColorStop(1, config.color2); 
      canvasContext.beginPath();
      canvasContext.moveTo(0, -config.tipWidth / 2);                      
      canvasContext.lineTo(0, config.tipWidth / 2);  
      canvasContext.lineTo(-config.length, config.baseWidth / 2); 
      canvasContext.lineTo(-config.length, -config.baseWidth / 2);  
      canvasContext.closePath();
      canvasContext.shadowBlur = shadow;
      canvasContext.shadowColor = 'rgba(0, 0, 0, 0.4)';
      canvasContext.fillStyle = gradient;
      canvasContext.fill();
      canvasContext.shadowBlur = 0; 
      canvasContext.strokeStyle = '#ffffff';
      canvasContext.lineWidth = 1.5;
      canvasContext.stroke();
      canvasContext.restore();
    }

    function drawClockBorder(innerRadius) {
      canvasContext.beginPath();
      canvasContext.arc(0, 0, innerRadius, 0, Math.PI * 2);
      canvasContext.lineWidth = 2;
      canvasContext.strokeStyle = '#333';
      canvasContext.stroke();
    }

    function drawOuterTickRing(specificRadius) {
      canvasContext.beginPath();
      canvasContext.arc(0, 0, specificRadius, 0, Math.PI * 2);
      canvasContext.lineWidth = 3.5;
      canvasContext.strokeStyle = '#666';
      canvasContext.stroke();
      for (let i = 0; i < 60; i++) {
        const angle = (i * Math.PI / 30) - Math.PI / 2;
        const majorTickLength = specificRadius * 0.06;
        const isMajor = (i % 5 === 0);
        const currentTickLength = isMajor ? majorTickLength : majorTickLength * 0.66;
        canvasContext.beginPath();
        canvasContext.moveTo(specificRadius * Math.cos(angle), specificRadius * Math.sin(angle));
        canvasContext.lineTo((specificRadius - currentTickLength) * Math.cos(angle), (specificRadius - currentTickLength) * Math.sin(angle));
        canvasContext.lineWidth = isMajor ? 2.5 : 1.2;
        canvasContext.strokeStyle = isMajor ? '#333' : '#888';
        canvasContext.stroke();
      }
    }

    function drawOuterStaticNumberRing(specificRadius) {
      const fontSize = specificRadius * 0.09; 
      canvasContext.font = `bold ${fontSize}px sans-serif`;
      canvasContext.textAlign = 'center';
      canvasContext.textBaseline = 'middle';
      canvasContext.fillStyle = '#444';
      for (let i = 0; i < 24; i++) {
        const angle = (i * Math.PI / 12) + Math.PI / 2;
        canvasContext.save();
        canvasContext.translate(specificRadius * Math.cos(angle), specificRadius * Math.sin(angle));
        canvasContext.rotate((i >= 6 && i <= 18) ? angle + Math.PI / 2 : angle - Math.PI / 2);
        canvasContext.fillText(i, 0, 0);
        canvasContext.restore();
      }
    }
    
    function drawHourNumbersAndCities(universalRadius) {
      const numberRingRadius = universalRadius * RADIUS_COEFFICIENTS.hourNumberRing;
      const cityRingRadius   = universalRadius * RADIUS_COEFFICIENTS.cityLabelRing;
      const outerReferenceRadius = universalRadius * RADIUS_COEFFICIENTS.outerTickRing;
      const numberFontSize = outerReferenceRadius * 0.05;
      const cityFontSize = outerReferenceRadius * 0.055;

      const now = new Date();
      const currentUtcHour = now.getUTCHours(); 
      const originHour = Math.floor(now.getUTCHours() + globalCities[originSelect.value].offset + 24) % 24;
      const destHour = Math.floor(now.getUTCHours() + globalCities[destSelect.value].offset + 24) % 24;

      canvasContext.save();
      for (let hour = 0; hour < 24; hour++) {
        const angle = ((currentUtcHour - hour) * Math.PI / 12) - Math.PI / 2;
        const isDark = (hour >= 19 || hour <= 6); 
        canvasContext.beginPath();
        canvasContext.arc(0, 0, numberRingRadius, angle - Math.PI / 24, angle + Math.PI / 24);
        canvasContext.strokeStyle = isDark ? '#1e1e1e' : '#f0f0f0';
        canvasContext.lineWidth = numberFontSize * 2.2;
        canvasContext.stroke();
      }
      canvasContext.restore();

      canvasContext.font = `bold ${numberFontSize}px sans-serif`;
      canvasContext.textAlign = 'center';
      canvasContext.textBaseline = 'middle';
      for (let hour = 0; hour < 24; hour++) {
        const angle = ((currentUtcHour - hour) * Math.PI / 12) - Math.PI / 2;
        canvasContext.save();
        canvasContext.translate(numberRingRadius * Math.cos(angle), numberRingRadius * Math.sin(angle));
        canvasContext.rotate(angle - Math.PI / 2); 
        if (hour === originHour) {
          canvasContext.strokeStyle = '#00FF00';
          canvasContext.lineWidth = 2.5;
          canvasContext.strokeRect(-numberFontSize*0.75, -numberFontSize*0.75, numberFontSize*1.5, numberFontSize*1.5);
        }
        if (hour === destHour) {
          canvasContext.strokeStyle = '#FF0000';
          canvasContext.lineWidth = 2.5;
          canvasContext.strokeRect(-numberFontSize*0.85, -numberFontSize*0.85, numberFontSize*1.7, numberFontSize*1.7);
        }
        canvasContext.fillStyle = (hour >= 19 || hour <= 6) ? '#ffffff' : '#222222';
        canvasContext.fillText(hour, 0, 0);
        canvasContext.restore();
      }

      canvasContext.font = `600 ${cityFontSize}px sans-serif`;
      ringLabels.forEach((zone, index) => {
        const angle = - (Math.PI / 2) - (zone.offset * (Math.PI / 12));
        const radiusWithStagger = cityRingRadius + ((index % 2 === 0) ? 0 : (universalRadius * RADIUS_COEFFICIENTS.cityLabelStagger));
        canvasContext.save();
        canvasContext.translate(radiusWithStagger * Math.cos(angle), radiusWithStagger * Math.sin(angle));
        canvasContext.rotate(Math.sin(angle) < 0 ? angle + Math.PI / 2 : angle - Math.PI / 2);
        canvasContext.fillStyle = '#222';
        canvasContext.fillText(zone.city, 0, 0);
        canvasContext.restore();
      });
    }

    function updateDigitalClocks() {
      const now = new Date();
      
      // UTC Clock
      digitalClockElement.textContent = `UTC: ${String(now.getUTCHours()).padStart(2, '0')}:${String(now.getUTCMinutes()).padStart(2, '0')}:${String(now.getUTCSeconds()).padStart(2, '0')}`;
      
      // Local Time Display (follows Middle Dropdown)
      const selectedCity = globalCities[tzSelect.value];
      const offset = selectedCity.offset;
      
      // Calculate local time based on UTC and offset
      const totalMinutes = now.getUTCHours() * 60 + now.getUTCMinutes() + (offset * 60);
      let localH = Math.floor(totalMinutes / 60) % 24;
      if (localH < 0) localH += 24;
      let localM = Math.floor(Math.abs(totalMinutes) % 60);
      
      const hStr = String(localH).padStart(2, '0');
      const mStr = String(localM).padStart(2, '0');
      const sStr = String(now.getUTCSeconds()).padStart(2, '0');
      const offsetStr = `UTC${offset >= 0 ? '+' : ''}${offset}`;
      
      localTimeDisplayElement.textContent = `${hStr}:${mStr}:${sStr} — ${selectedCity.name} (${offsetStr})`;
    }

    onWindowResize();
    setInterval(() => {
      drawClockFace();
      updateDigitalClocks();
    }, 1000);
  </script>
</body>
</html>

