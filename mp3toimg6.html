<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Spectrogram Player (Fixed + Annotations)</title>
  <style>
    body { background: #111; color: #fff; font-family: sans-serif; margin: 0; text-align: center; }
    .controls { padding: 10px; }
    .controls > * { margin: 6px; font-size: 16px; }
    #timeStatus { margin-top: 6px; font-size: 14px; font-style: italic; }
    .canvasRowContainer { position: relative; display: inline-block; margin-bottom: 20px; }
    canvas.spectrogramCanvas { background: #000; display: block; }
    canvas.cursorOverlayCanvas { position: absolute; left: 0; top: 0; pointer-events: auto; }
    canvas.annotationCanvas {
      position: absolute;
      left: 0;
      width: 100%;
      height: 20px;
      bottom: 0;
      pointer-events: auto;
      z-index: 2;
    }
    #playerControls { margin: 10px; display: none; }
    #playerControls button { margin: 0 6px; font-size: 16px; padding: 6px 12px; }
  </style>
</head>
<body>
  <h1>Spectrogram Player (Fixed + Annotations)</h1>
  <div class="controls">
    <input type="file" id="fileInput" accept=".mp3">
    <label> Speed:
      <select id="playbackSpeedSelect">
        <option>1</option><option>2</option><option>4</option>
        <option>30</option><option>60</option><option>120</option>
      </select> ×
    </label>
    <button id="startGenerateButton">Play (Phase 1)</button>
    <button id="pauseGenerateButton" disabled>Pause</button>
    <button id="exportButton">Download Spectrogram</button>
    <label><input type="checkbox" id="annotationModeToggle"> Annotation Mode</label>
    <select id="annotationColorSelect">
      <option value="#f00">Red</option>
      <option value="#0f0">Green</option>
      <option value="#00f">Blue</option>
      <option value="#ff0">Yellow</option>
      <option value="erase">Eraser</option>
    </select>
    <div id="timeStatus">No file loaded.</div>
    <div id="fileDurationStatus"></div>
  </div>
  <div id="playerControls">
    <button id="rewind15Seconds">◀ 15 s</button>
    <button id="playPauseButton">Play/Pause</button>
    <button id="forward15Seconds">15 s ▶</button>
  </div>
  <div id="rowsContainer"></div>
  <script>
    // JS is loaded separately to keep the HTML clean
  </script>
</body>
</html>