if (audio.ended || audio.currentTime >= audio.duration) {
  spectrogramComplete = true;

  // Fill remainder of last row with checkerboard if not complete
  const last = spectroCanvases[spectroCanvases.length - 1];
  if (drawX < canvasWidth) {
    const ctx = last.ctx;
    const squareSize = 6;

    for (let x = drawX; x < canvasWidth; x += squareSize) {
      for (let y = 0; y < usableHeight; y += squareSize) {
        const isLight = ((x / squareSize) ^ (y / squareSize)) % 2 === 0;
        ctx.fillStyle = isLight ? '#444' : '#222';
        ctx.fillRect(x, y, squareSize, squareSize);
      }
    }
  }

  navButtons.style.display = 'block';
  audio.currentTime = 0;
  setupPhase2();
}
